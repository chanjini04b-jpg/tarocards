<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <!-- ================== ê¸°ë³¸ ë©”íƒ€ íƒœê·¸ (SEO) ================== -->
    <meta name="title" content="íƒ€ë¡œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ì§„ë‹¨">
    <meta name="description" content="íƒ€ë¡œ ì‹œìŠ¤í…œì˜ ì˜¤ë¥˜ë¥¼ ë‹¨ê³„ë³„ë¡œ ì§„ë‹¨í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” í˜ì´ì§€">
    <meta name="keywords" content="íƒ€ë¡œ, ì˜¤ë¥˜, ì§„ë‹¨, í…ŒìŠ¤íŠ¸, ì‹œìŠ¤í…œ ì ê²€, ë””ë²„ê·¸">
    <meta name="author" content="Historical Tarot Team">
    <meta name="robots" content="noindex, nofollow">

    <!-- ================== Open Graph ë©”íƒ€ íƒœê·¸ ================== -->
    <meta property="og:title" content="íƒ€ë¡œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ì§„ë‹¨">
    <meta property="og:description" content="íƒ€ë¡œ ì‹œìŠ¤í…œì˜ ì˜¤ë¥˜ë¥¼ ë‹¨ê³„ë³„ë¡œ ì§„ë‹¨í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” í˜ì´ì§€">
    <meta property="og:type" content="website">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="íƒ€ë¡œ ì˜¤ë¥˜ ì§„ë‹¨ ëŒ€í‘œ ì´ë¯¸ì§€">
    <meta property="og:site_name" content="Historical Tarot">
    <meta property="og:locale" content="ko_KR">
        <meta property="og:url" content="https://tarocards.netlify.app/diagnosis.html">
        <meta property="og:image" content="https://tarocards.netlify.app/images/og-image.jpg">

    <!-- ================== Twitter ì¹´ë“œ ë©”íƒ€ íƒœê·¸ ================== -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="íƒ€ë¡œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ì§„ë‹¨">
    <meta name="twitter:description" content="íƒ€ë¡œ ì‹œìŠ¤í…œì˜ ì˜¤ë¥˜ë¥¼ ë‹¨ê³„ë³„ë¡œ ì§„ë‹¨í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” í˜ì´ì§€">
        <meta name="twitter:image" content="https://tarocards.netlify.app/images/og-image.jpg">
    <meta name="twitter:image:alt" content="íƒ€ë¡œ ì˜¤ë¥˜ ì§„ë‹¨ ëŒ€í‘œ ì´ë¯¸ì§€">
    <meta name="twitter:site" content="@historicaltarot">
    <meta name="twitter:creator" content="@historicaltarot">

    <!-- ================== SEO ë° ì‚¬ìš©ì ê²½í—˜ ë³´ì™„ íƒœê·¸ ================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="language" content="ko">
    <meta name="distribution" content="global">
    <meta name="rating" content="general">
    <meta name="format-detection" content="telephone=no">
        <link rel="canonical" href="https://tarocards.netlify.app/diagnosis.html">

    <!-- ================== ì›¹ì•± ë° ë¸Œë¼ìš°ì € ìµœì í™” ================== -->
    <meta name="theme-color" content="#ffffff">
    <meta name="application-name" content="Historical Tarot">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Historical Tarot">

    <!-- ================== ì•„ì´ì½˜ ë° ë¦¬ì†ŒìŠ¤ ë§í¬ ================== -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <title>íƒ€ë¡œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ì§„ë‹¨</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a2e; color: white; }
        .log { background: #16213e; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .error { color: #ff6b6b; }
        .success { color: #51cf66; }
        .warning { color: #ffd43b; }
        .info { color: #74c0fc; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>ğŸ” íƒ€ë¡œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ì§„ë‹¨</h1>
    
    <div id="step1" class="log">
        <h3>1ë‹¨ê³„: ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© í™•ì¸</h3>
        <div id="step1-result">í™•ì¸ ì¤‘...</div>
    </div>
    
    <div id="step2" class="log">
        <h3>2ë‹¨ê³„: JSON íŒŒì¼ ì ‘ê·¼ í…ŒìŠ¤íŠ¸</h3>
        <div id="step2-result">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div id="step3" class="log">
        <h3>3ë‹¨ê³„: í´ë˜ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸</h3>
        <div id="step3-result">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div id="step4" class="log">
        <h3>4ë‹¨ê³„: ë°ì´í„° ë¡œë”© í…ŒìŠ¤íŠ¸</h3>
        <div id="step4-result">ëŒ€ê¸° ì¤‘...</div>
    </div>
    
    <div id="step5" class="log">
        <h3>5ë‹¨ê³„: ì¹´ë“œ ë½‘ê¸° í…ŒìŠ¤íŠ¸</h3>
        <div id="step5-result">ëŒ€ê¸° ì¤‘...</div>
    </div>

    <script src="javascript/backup-data.js"></script>
    <script src="javascript/tarot.js"></script>
    
    <script>
        let currentStep = 1;
        let deck = null;
        
        function logResult(step, message, type = 'info') {
            const element = document.getElementById(`step${step}-result`);
            const className = type;
            element.innerHTML = `<span class="${className}">${message}</span>`;
            console.log(`Step ${step}: ${message}`);
        }
        
        function logError(step, error) {
            logResult(step, `âŒ ì˜¤ë¥˜: ${error.message}\nìƒì„¸: ${error.stack}`, 'error');
        }
        
        async function runDiagnostics() {
            try {
                // 1ë‹¨ê³„: ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© í™•ì¸
                logResult(1, 'âœ… ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ë“¤ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                
                // í´ë˜ìŠ¤ ì¡´ì¬ í™•ì¸
                if (typeof HistoricalTarotDeck === 'undefined') {
                    logResult(1, 'âŒ HistoricalTarotDeck í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }
                logResult(1, 'âœ… HistoricalTarotDeck í´ë˜ìŠ¤ ë°œê²¬', 'success');
                
                // 2ë‹¨ê³„: JSON íŒŒì¼ ì ‘ê·¼ í…ŒìŠ¤íŠ¸
                try {
                    logResult(2, 'ğŸ“¡ JSON íŒŒì¼ ìš”ì²­ ì¤‘...', 'info');
                    
                    const cardsResponse = await fetch('./tarot_cards.json');
                    logResult(2, `ì¹´ë“œ ë°ì´í„° ì‘ë‹µ: ${cardsResponse.status} ${cardsResponse.statusText}`, 'info');
                    
                    if (!cardsResponse.ok) {
                        throw new Error(`ì¹´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${cardsResponse.status}`);
                    }
                    
                    const cardsData = await cardsResponse.json();
                    logResult(2, `âœ… ì¹´ë“œ ë°ì´í„° ë¡œë“œ ì„±ê³µ: ${cardsData.length}ê°œ ì¹´ë“œ`, 'success');
                    
                    const backgroundsResponse = await fetch('./tarot_card_backgrounds_simple.json');
                    logResult(2, `ë°°ê²½ ë°ì´í„° ì‘ë‹µ: ${backgroundsResponse.status} ${backgroundsResponse.statusText}`, 'info');
                    
                    if (!backgroundsResponse.ok) {
                        throw new Error(`ë°°ê²½ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${backgroundsResponse.status}`);
                    }
                    
                    const backgroundsData = await backgroundsResponse.json();
                    logResult(2, `âœ… ë°°ê²½ ë°ì´í„° ë¡œë“œ ì„±ê³µ: ${backgroundsData.length}ê°œ ë°°ê²½`, 'success');
                    
                } catch (error) {
                    logError(2, error);
                    return;
                }
                
                // 3ë‹¨ê³„: í´ë˜ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
                try {
                    logResult(3, 'ğŸ—ï¸ HistoricalTarotDeck ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì¤‘...', 'info');
                    deck = new HistoricalTarotDeck();
                    logResult(3, 'âœ… í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ', 'success');
                } catch (error) {
                    logError(3, error);
                    return;
                }
                
                // 4ë‹¨ê³„: ë°ì´í„° ë¡œë”© í…ŒìŠ¤íŠ¸
                try {
                    logResult(4, 'ğŸ“¥ ë°ì´í„° ë¡œë”© ì‹œì‘...', 'info');
                    await deck.loadData();
                    logResult(4, `âœ… ë°ì´í„° ë¡œë”© ì™„ë£Œ: isLoaded=${deck.isLoaded}, cards=${deck.cards?.length}`, 'success');
                } catch (error) {
                    logError(4, error);
                    return;
                }
                
                // 5ë‹¨ê³„: ì¹´ë“œ ë½‘ê¸° í…ŒìŠ¤íŠ¸
                try {
                    logResult(5, 'ğŸ´ ì¹´ë“œ ë½‘ê¸° í…ŒìŠ¤íŠ¸...', 'info');
                    const drawnCards = deck.drawCards(3);
                    logResult(5, `âœ… ì¹´ë“œ ë½‘ê¸° ì„±ê³µ: ${drawnCards.map(c => c.name_ko).join(', ')}`, 'success');
                    
                    // ì „ì²´ ì„±ê³µ
                    document.body.insertAdjacentHTML('beforeend', `
                        <div class="log" style="background: #2d8653; text-align: center;">
                            <h2>ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼! ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.</h2>
                        </div>
                    `);
                    
                } catch (error) {
                    logError(5, error);
                    return;
                }
                
            } catch (globalError) {
                console.error('ì§„ë‹¨ ì¤‘ ì „ì—­ ì˜¤ë¥˜:', globalError);
                document.body.insertAdjacentHTML('beforeend', `
                    <div class="log" style="background: #c92a2a;">
                        <h3>âŒ ì „ì—­ ì˜¤ë¥˜ ë°œìƒ</h3>
                        <pre>${globalError.message}\n${globalError.stack}</pre>
                    </div>
                `);
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ í›„ ì§„ë‹¨ ì‹œì‘
        document.addEventListener('DOMContentLoaded', () => {
            console.log('=== íƒ€ë¡œ ì‹œìŠ¤í…œ ì§„ë‹¨ ì‹œì‘ ===');
            runDiagnostics();
        });
        
        // ì „ì—­ ì˜¤ë¥˜ ê°ì§€
        window.addEventListener('error', function(e) {
            console.error('ì „ì—­ ì˜¤ë¥˜ ê°ì§€:', e.error);
            document.body.insertAdjacentHTML('beforeend', `
                <div class="log" style="background: #c92a2a;">
                    <h3>âš ï¸ ì „ì—­ ì˜¤ë¥˜ ê°ì§€</h3>
                    <pre>${e.error?.message}\n${e.error?.stack}</pre>
                </div>
            `);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('ì²˜ë¦¬ë˜ì§€ ì•Šì€ Promise ê±°ë¶€:', e.reason);
            document.body.insertAdjacentHTML('beforeend', `
                <div class="log" style="background: #c92a2a;">
                    <h3>âš ï¸ Promise ê±°ë¶€</h3>
                    <pre>${e.reason}</pre>
                </div>
            `);
        });
    </script>
</body>
</html>